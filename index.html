<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All In One - Tư Ngữ Audio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="app-container">
    <header class="app-header">
        <div class="brand">
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
            All In One <span>Tư Ngữ Audio</span>
        </div>
        <div style="font-size: 0.8rem; color: var(--text-muted);">v2025.19.12</div>
    </header>

    <aside class="sidebar">
        <div class="sidebar-tabs">
            <button class="tab-btn active" onclick="switchTab('fetch')">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                Lấy dữ liệu
            </button>
            <button class="tab-btn" onclick="switchTab('search')">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                Tìm kiếm & Thay thế
            </button>
        </div>

        <div id="tab-fetch" class="tab-content active">
            <div class="input-group">
                <div class="section-title">
                    <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>
                    Danh sách Link
                </div>
                <textarea id="links" placeholder="Mỗi dòng một link..." style="height: 100px;"></textarea>
            </div>

            <div class="input-group">
                <div class="section-title">
                    <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg>
                    Cấu hình Nguồn
                </div>
                
                <div class="radio-grid">
                    <div class="radio-item"><input type="radio" id="s_custom" name="sourceType" value="custom" onchange="toggleConfig()" checked><label for="s_custom">Custom</label></div>
                    <div class="radio-item"><input type="radio" id="s_mongtruyen" name="sourceType" value="mongtruyen" onchange="toggleConfig()"><label for="s_mongtruyen">Mộng Truyện</label></div>
                    <div class="radio-item"><input type="radio" id="s_truyenfull" name="sourceType" value="truyenfull" onchange="toggleConfig()"><label for="s_truyenfull">Truyện Full</label></div>
                    <div class="radio-item"><input type="radio" id="s_wattpad" name="sourceType" value="wattpadvn" onchange="toggleConfig()"><label for="s_wattpad">WattpadVN</label></div>
		    <div class="radio-item"><input type="radio" id="s_wattpadcom" name="sourceType" value="wattpadcom" onchange="toggleConfig()"><label for="s_wattpadcom">WattpadCOM</label></div>
                </div>

                <div id="customConfigBox" style="margin-top: 5px; display: flex; flex-direction: column; gap: 8px;">
                    <input id="customSelectors" placeholder="Selector (VD: .post-body)" />
                </div>
                
                <input id="hiddenCode" placeholder="Regex xóa rác (VD: position: absolute;)" />
            </div>

            <div>
                <button class="btn-primary" id="startBtn" onclick="startFetch()">
                    <div class="spinner" id="btnSpinner"></div>
                    <span id="btnText">Bắt đầu Fetch Dữ Liệu</span>
                </button>
                <div class="progress-wrapper" id="progressContainer">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
            </div>

            <div class="input-group" style="margin-top: 5px; border-top: 1px solid var(--border-subtle); padding-top: 15px;">
                <div class="section-title" style="color: var(--accent);">
                    <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                    Box Hiệu Chỉnh
                </div>
                <textarea id="promoKeywords" placeholder="Nhập từ khóa ngăn cách bởi dấu phẩy..." style="height: 60px; font-size: 0.75rem;"></textarea>
                <button class="btn-secondary" onclick="injectPromo()">Chèn Lời Kêu Gọi</button>
            </div>
        </div>

        <div id="tab-search" class="tab-content">
            <div class="input-group">
                <div class="section-title" style="color: var(--primary);">Tìm kiếm</div>
                <textarea id="findStr" placeholder="Nhập văn bản cần tìm (Hỗ trợ nhiều dòng)..." style="height: 100px; border-color: var(--primary);"></textarea>
                <div class="checkbox-row">
                    <input type="checkbox" id="useRegex"> <label for="useRegex" title="Sử dụng biểu thức chính quy">Regex Mode</label>
                    <input type="checkbox" id="caseSensitive" style="margin-left: 15px;"> <label for="caseSensitive">Phân biệt hoa/thường</label>
                </div>
            </div>

            <div class="input-group">
                <div class="section-title" style="color: var(--success);">Thay thế bằng</div>
                <textarea id="replaceStr" placeholder="Nội dung thay thế (Hỗ trợ nhiều dòng)..." style="height: 80px; border-color: var(--success);"></textarea>
            </div>

            <div id="navControls" class="nav-controls">
                <button class="btn-nav" onclick="navMatch(-1)" title="Trước">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                </button>
                <div class="nav-counter" id="navCounter">0 / 0</div>
                <button class="btn-nav" onclick="navMatch(1)" title="Sau">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </button>
            </div>

            <div style="display: flex; gap: 10px; flex-direction: column;">
                <button class="btn-secondary" onclick="initSearch()">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right:5px"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    Duyệt tìm
                </button>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-secondary" onclick="replaceOne()" style="border-color: var(--success); color: var(--success);">Thay thế hiện tại</button>
                    <button class="btn-primary" onclick="replaceAll()" style="background: linear-gradient(135deg, var(--success), #059669);">Thay thế Hết</button>
                </div>
            </div>
        </div>

        <div class="log-container">
            <div class="log-header">
                <span>System Logs</span>
                <span id="logStatus" style="opacity: 0.6">Ready</span>
            </div>
            <div class="log-content" id="logBox">
                <span style="opacity: 0.3; font-style: italic;">Chờ lệnh xử lý...</span>
            </div>
        </div>
    </aside>

    <main class="main-area">
        <div class="toolbar">
            <button class="btn-tool" onclick="formatWattpad()">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                Lọc Wattpad + Link
            </button>
            <button class="btn-tool" onclick="formatTYT()">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                Lọc Ký Tự TYT
            </button>
            <button class="btn-tool" onclick="formatVanAn()" title="Chuyển thành chuỗi escape \n">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg>
                Format Văn Án
            </button>
            <button class="btn-tool" onclick="removeEmptyLines()">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                Xóa Dòng Trống
            </button>
            <button class="btn-tool" onclick="forceRenderHTML()">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                Render HTML
            </button>
            <button class="btn-tool danger" onclick="clearEditor()" style="margin-left: auto">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                Xóa
            </button>
        </div>

        <div class="editor-wrapper">
            <div class="editor-header">
                <span>TEXT EDITOR</span>
                <span id="charCount">0 chars</span>
            </div>
            <textarea id="editor" placeholder="Nội dung sau khi fetch sẽ hiển thị tại đây..." oninput="onEditorInput()"></textarea>
        </div>

        <div class="action-footer">
            <button class="btn-action" onclick="downloadText()">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                Tải xuống .TXT
            </button>
            <button class="btn-action primary" onclick="copyText()">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg>
                Copy To Clipboard
            </button>
        </div>
    </main>
</div>

<div id="toast-container"></div>

<script src="main.js"></script>
</body>
</html>